<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Share secrets between team members, manage your personal password, multi device, gpg, happiness.">
<meta name="viewport" content="width=device-width">
<title>Sharing passwords using gopass, git and gpg | Willy's blog</title>
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/index.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://woile.github.io/posts/sharing-team-secrets/">
<!--[if lt IE 9]><script src="../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Woile">
<link rel="prev" href="../raspberries-hobby-cluster/" title="Raspberry Pi hobby cluster" type="text/html">
<link rel="next" href="../pycon-france-2019-experience/" title="PyCon France 2019 experience" type="text/html">
<meta property="og:site_name" content="Willy's blog">
<meta property="og:title" content="Sharing passwords using gopass, git and gpg">
<meta property="og:url" content="https://woile.github.io/posts/sharing-team-secrets/">
<meta property="og:description" content="Share secrets between team members, manage your personal password, multi device, gpg, happiness.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-03-18T13:34:36-03:00">
<meta property="article:tag" content="encryption">
<meta property="article:tag" content="gpg">
<meta property="article:tag" content="password manager">
<meta property="article:tag" content="security">
</head>
<body>
    <input id="dark-mode" type="checkbox"><div class="theme">
        <div class="layout">
                <header class="cover"><h3 id="brand"><a href="../../" title="Willy's blog" rel="home">
            <span id="blog-title">Willy's blog</span>
        </a></h3>

    <div>
    <label class="dark-mode-label" for="dark-mode"></label>
    
    </div>


    </header><input id="cool-menu" type="checkbox"><label for="cool-menu" class="cool-menu__label">
        <svg class="cool-menu hover:cool-menu checked:cool-menu" viewbox="0 0 100 100" width="40" height="40" aria-hidden="true"><circle cx="50" cy="50" r="50" fill-opacity="0.5"></circle></svg></label>
        <nav class="menu"><ul>
<li><a href="../../">Home</a></li>
                <li><a href="../../blog/">Blog</a></li>
                <li><a href="../../archive.html">Archives</a></li>
                <li><a href="../../categories/index.html">Tags</a></li>
                <li><a href="../../rss.xml">RSS feed</a></li>

    
    
    
    </ul></nav><main id="content" class="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h2 class="p-name entry-title header__title" itemprop="headline name"><a href="." class="u-url hover:header__title__link">Sharing passwords using gopass, git and gpg</a></h2>

        <div class="metadata">
            <span class="byline author vcard p-author h-card">
            <span class="byline-name fn p-name" itemprop="author">
                    Woile
            </span>
            </span>
                | <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/encryption/" rel="tag">#encryption</a>
                | <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/gpg/" rel="tag">#gpg</a>
                | <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/password-manager/" rel="tag">#password manager</a>
                | <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/security/" rel="tag">#security</a>
            <span class="dateline">
            <a class="article__meta__link hover:article__meta__link" href="." rel="bookmark">
            <time class="published dt-published" datetime="2019-03-18T13:34:36-03:00" itemprop="datePublished" title="2019-03-18 13:34">2019-03-18 13:34</time></a>
            </span>
                <span class="commentline">            <a href="#disqus_thread" data-disqus-identifier="cache/posts/sharing-team-secrets.html">Comments</a>


                    | <span class="sourceline"><a class="article__meta__link hover:article__meta__link" href="index.rst">Source</a></span>

        </span>
</div>
        
    </header><section class="e-content entry-content" itemprop="articleBody text"><div>
<div class="line-block">
<div class="line">Tired of storing your passwords in unreliable but convenient places?</div>
</div>
<div class="line-block">
<div class="line">Tired of sharing password across unreliable platforms? slack, notes, etc</div>
</div>
<div class="line-block">
<div class="line">Tired of having your team passwords in no specific place?</div>
</div>
<div class="line-block">
<div class="line">If you have answer to any of this questions with a yes, then you might find</div>
<div class="line">this post quite useful. If your answer was no, read it anyway, you are</div>
<div class="line">already here.</div>
</div>
<img src="https://media.giphy.com/media/5VKbvrjxpVJCM/giphy.gif"><!-- TEASER_END --><div class="section" id="background">
<h2>Background</h2>
<p>For quite some time, I've been trying to solve this problem I had in my mind.
I was looking for a way to store my passwords (I'll refer to them as
secrets also) in a secure way.
But also, I wanted these features:</p>
<ul class="simple">
<li><p>Storing passwords in the cloud</p></li>
<li><p>Easy to synchronize between devices</p></li>
<li><p>Easy to share between teammates (groups)</p></li>
</ul>
<p>The solution I found was <a class="reference external" href="https://www.gopass.pw/">gopass</a>.</p>
</div>
<div class="section" id="how-it-works">
<h2>How it works</h2>
<p>Basically <a class="reference external" href="https://www.gopass.pw/">gopass</a> is like <a class="reference external" href="https://passwordstore.org">pass</a> (the unix password manager) with an extra
pair of batteries.</p>
<p>Among others, the features it has, relevant to me, are:</p>
<ol class="arabic simple">
<li><p>Uses <strong>gpg</strong> for secrets encryption.</p></li>
<li><p>Uses <strong>git</strong> for secrets synchronization.</p></li>
<li><p>Multiple password's <strong>stores</strong> (personal, company, etc).</p></li>
<li><p>Each store can point to a different repository.</p></li>
<li><p>Support for <strong>multiple people</strong> per store, called recipients in the jargon.</p></li>
</ol>
<img src="https://media.giphy.com/media/MWKPjY6uapZENHlzXT/giphy.gif"><p>Even though it lacks a bit in documentation, the commands just do what's
expected of them. So don't be afraid to play with it.</p>
<p>Regarding gpg, it makes me glad to start wrapping my mind around it, and gopass
using it, well, makes my day :)</p>
<p>The only drawback I found is the lack of official windows support. I don't
know if it works or not in windows.</p>
</div>
<div class="section" id="installation">
<h2>Installation</h2>
<p>You can check the website's <a class="reference external" href="https://www.gopass.pw/#install">installation</a> or you can go to a more in depth
explanation in gopass <a class="reference external" href="https://github.com/gopasspw/gopass/blob/master/docs/setup.md">repo</a>.</p>
</div>
<div class="section" id="usage">
<h2>Usage</h2>
<p>First of all, we are gonna need a gpg key.
To create one, gopass it's not needed.
Instaed, we are gonna use gpg cli that should be in your system if you have
installed gopass.</p>
<p><strong>How does gpg work?</strong></p>
<p>In the context of gopass, we are gonna use the public and private keys provided
by gpg.</p>
<p>Imagine you have an infinite amount of boxes (public key), that once they are
closed, they can only be open with a key that only you have (private key).</p>
<p>From this analogy, we can conclude 2 things:</p>
<p>1. You <strong>can distribute your public keys</strong> and let anyone encrypt
information with it.
Let's say I give boxes to friends, they put something inside and close it.
That's it, only I will be able to open it. And of course, I can also encrypt
my stuff, in case some is sniffing around.</p>
<p>2. <strong>Private keys are really important</strong>, keep them safe, don't lose them,
and make a backup. You can use an encrypted pendrive, a paper note in a
safe place, or a <a class="reference external" href="https://www.yubico.com/">yubikey</a>. Would be nice if companies give yubikeys to their
employees, right?</p>
<p><strong>Creating a key</strong></p>
<p>Simple as following the prompt that appears after typing the command.
If you don't know what to fill, use the default values.</p>
<pre class="code bash"><a name="rest_code_a9ab999f8be149619a71957a37719537-1"></a>gpg --full-generate-key
</pre>
<p>And check the generatd key</p>
<pre class="code bash"><a name="rest_code_94237bbdb3ed462b8950263315e46804-1"></a>gpg -k
</pre>
<div class="section" id="initializing-gopass">
<h3>Initializing gopass</h3>
<p>Easy as typing</p>
<pre class="code bash"><a name="rest_code_a003947d7b424be694e4f44bfc4419f9-1"></a>gopass init
</pre>
<p>This will set up some stuff and will create the default store.</p>
<p>I recommend adding the autocomplete to your terminal</p>
<pre class="code bash"><a name="rest_code_00f9a0c7d0934b268babc98e975a363d-1"></a><span class="nb">echo</span> <span class="s2">"source &lt;(gopass completion bash)"</span> &gt;&gt; ~/.bashrc
</pre>
</div>
<div class="section" id="using-gopass">
<h3>Using gopass</h3>
<p>Gopass works in a "unix" like way.
You'll have a tree (folders) where the leaves are encrypted files.</p>
<pre class="code text"><a name="rest_code_f33c316927864777b1634da5d9572813-1"></a>gopass
<a name="rest_code_f33c316927864777b1634da5d9572813-2"></a>    ├── my-company
<a name="rest_code_f33c316927864777b1634da5d9572813-3"></a>    │   └── pepe@my-company.com
<a name="rest_code_f33c316927864777b1634da5d9572813-4"></a>    └── personal
<a name="rest_code_f33c316927864777b1634da5d9572813-5"></a>        └── pepe@personal.com
</pre>
<p>Let's begin by <strong>inserting</strong> a secret.</p>
<pre class="code bash"><a name="rest_code_84d41b01004945e8bf7134865710cb51-1"></a>gopass insert personal/twitter/santiwilly
</pre>
<p>It will show a prompt and you'll have to fill the password twice.
The structure I follow is this (most of them optional)
<code class="docutils literal"><span class="pre">{store}/{org}/{env}/{username</span> or email}</code>.</p>
<p>Now let's <strong>list</strong> our secret, by simply doing</p>
<pre class="code bash"><a name="rest_code_fa1ad5b03b0f400ba24971082353749e-1"></a>gopass ls
</pre>
<p>We should now see, something like this.</p>
<pre class="code text"><a name="rest_code_b75dc7575b5e4a97b8f792ea029b7af0-1"></a>gopass
<a name="rest_code_b75dc7575b5e4a97b8f792ea029b7af0-2"></a>    ├── my-company
<a name="rest_code_b75dc7575b5e4a97b8f792ea029b7af0-3"></a>    │   └── pepe@my-company.com
<a name="rest_code_b75dc7575b5e4a97b8f792ea029b7af0-4"></a>    └── personal
<a name="rest_code_b75dc7575b5e4a97b8f792ea029b7af0-5"></a>        ├── pepe@personal.com
<a name="rest_code_b75dc7575b5e4a97b8f792ea029b7af0-6"></a>        └── twitter
<a name="rest_code_b75dc7575b5e4a97b8f792ea029b7af0-7"></a>            └── santiwilly
</pre>
<p>Perfect!</p>
<p>Let's continue. I'm just gonna throw you the commands, they don't have any
complexity.</p>
<p><strong>Show password</strong></p>
<pre class="code bash"><a name="rest_code_3d452183577a45ae83fdbb5e983dcdf7-1"></a>gopass personal/twitter/santiwilly
</pre>
<p><strong>Copy password to clipboard</strong></p>
<pre class="code bash"><a name="rest_code_08e5720987044225b3b154c31340ed1c-1"></a>gopass -c personal/twitter/santiwilly
</pre>
<p><strong>Generate random pass</strong></p>
<pre class="code bash"><a name="rest_code_57c0933463494123a1c234ab91bbdc91-1"></a>gopass generate my-company/anothername@rmail.com
</pre>
<p><strong>Search secrets</strong></p>
<pre class="code bash"><a name="rest_code_2312afc211a446539fbb59fd1b162352-1"></a>gopass search @gmail.com
</pre>
</div>
<div class="section" id="using-stores">
<h3>Using stores</h3>
<p>Here's were my journey got a bit complicated, as I mentioned the docs are
not necessary bad, but you can get lost, maybe the website could be organized
a bit better. So I ended up creating multiple docker containers and started
playing around.</p>
<p>Stores (AKA <strong>mounts</strong>) let you group your passwords.
Example: <code>personal</code>, <code>company</code>.
Each one can live in a different repository, and you could potentially,
share <code>company</code> with your peers.</p>
<p><strong>Initialize new store</strong></p>
<p>Creates a new store located at <code class="docutils literal"><span class="pre">~/.password-store-my-company</span></code>.</p>
<pre class="code bash"><a name="rest_code_080a3a2dcaec4e7faa79f2631f918a56-1"></a>gopass init --store my-company
</pre>
<p><strong>Add git remote to store</strong></p>
<pre class="code bash"><a name="rest_code_c6826015187d4e55a2be18ec9ce30eb7-1"></a>gopass git remote add --store my-company origin git@gh.com/Woile/keys.git
</pre>
<p><strong>Clone existing store</strong></p>
<p>Let's say you move to another computer, now it's where gopass starts to shine.
Whether you use the same private key (imported in different computers) or you
choose to have a key per machine, to clone a repo, you just need
access to it.</p>
<pre class="code bash"><a name="rest_code_dcb13c15e6b44a3b8ecbb919c4df0b42-1"></a>gopass clone git@gh.com/Woile/keys.git my-company --sync gitcli
</pre>
<p>It's important to specify <code class="docutils literal">gitcli</code> as the <code class="docutils literal">sync</code> method. Otherwise gopass
won't know how to synchronize the secret (it will use <code class="docutils literal">noop</code> by default).
Gopass provides other sync methods but I haven't checked them.</p>
<p>Solutions that provide a free private repo are:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.gitlab.com">gitlab</a></p></li>
<li><p><a class="reference external" href="https://github.com">github</a></p></li>
<li><p><a class="reference external" href="https://bitbucket.org/product">bitbucket</a></p></li>
</ul>
<p><strong>Removing existing store</strong></p>
<p>To avoid having issues with gopass, first we need to unmount the store.</p>
<pre class="code bash"><a name="rest_code_1b23d4d71401407aaeedfb61d959dd18-1"></a>gopass mounts umount my-company
</pre>
<p>Now that we've done this, it's safe to remove the folder.</p>
<pre class="code bash"><a name="rest_code_535afe6ee8214ad4812e051f20c64539-1"></a>rm -rf ~/.password-store-my-company
</pre>
</div>
<div class="section" id="synchronization">
<h3>Synchronization</h3>
<p>In gopass, sync usually means <code class="docutils literal">git pull</code> and <code class="docutils literal">git push</code>, maybe also commit
but I'm not sure. Usually the commits are done on <code class="docutils literal">gopass insert</code>.</p>
<p><strong>Synchronize with git remotes</strong></p>
<pre class="code bash"><a name="rest_code_79acd21ac2b54ba1a0f4d934ed12cc0a-1"></a>gopass sync
</pre>
<p><strong>Synchronzing a single store</strong></p>
<pre class="code bash"><a name="rest_code_c11028195417424d935a228340438222-1"></a>gopass sync --store my-company
</pre>
</div>
<div class="section" id="team-sharing">
<h3>Team sharing</h3>
<p>We are finally on the last and most fantastic part,
sharing secrets with people.</p>
<p>Suppose we have a colleague with an email <code class="docutils literal">logan@pm.me</code>. This person has
already generated a gpg key, for that email, in they machine.</p>
<p>Logan then, must <strong>export the public key</strong> and send it to us.</p>
<pre class="code bash"><a name="rest_code_ddb52a90c6dc4d0ab81abe0f01255cbe-1"></a>gpg -a --export logan@pm.me &gt; logan.pub.asc
</pre>
<p>It's okay, public keys can be shared in untrusted environments. If you are
still not convinced, try <a class="reference external" href="https://send.firefox.com">send</a> from firefox. Keep in mind that people share
their public keys in keyservers, like <a class="reference external" href="https://pgp.surfnet.nl/">opengpgkeyserver</a>.</p>
<p><strong>Adding public key into gopass</strong></p>
<p>We have the public key, now it's time to <strong>import</strong> it into our
local gpg keyring.</p>
<pre class="code bash"><a name="rest_code_e103f7f574aa414a8b5206bdd62992e7-1"></a>gpg --import &lt; logan.pub.asc
</pre>
<p>And lastly, we need to <strong>add the new key to a gopass store</strong>.</p>
<pre class="code bash"><a name="rest_code_2daecc30eecf4150a2f175d6592ea1ef-1"></a>gopass recipients add logan@pm.me
</pre>
<p>You'll see a prompt with all of your stores. Choose the one you want, and it
will re-encrypt your secrets with the new public key (plus the existing ones).</p>
<p>And that's it, we are done. You can of course remove recipients, but I'll let
you do the search, tip: <code class="docutils literal">gopass recipients <span class="pre">--help</span></code>.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion</h2>
<p>I have created a gopass <a class="reference external" href="https://woile.github.io/gopass-cheat-sheet/">cheat sheet</a> with these commands and
a <a class="reference external" href="https://woile.github.io/gopass-presentation/">presentation</a> to convince your colleagues.</p>
<img src="https://media.giphy.com/media/3ohhwo81vLfGfDsDrG/giphy.gif"><p>Gopass is an awesome tool to include in your toolbelt.
Unfortunately, it is not that easy for non-developers, but still possible.</p>
<p>Some extra tools I use to enhance my gopass experience are:</p>
<p><a class="reference external" href="https://github.com/zeapo/Android-Password-Store">Android password store</a></p>
<p>I suggest installing it using F-droid, you'll need OpenKey-chain to create
a new gpg key, and you already know how to add multiple recipients to
your stores.</p>
<p><a class="reference external" href="https://github.com/gopasspw/gopassbridge">Gopass bridge</a></p>
<p>Browser extension for Firefox or Chrome that let's you access your stores.</p>
<p><a class="reference external" href="https://github.com/codecentric/gopass-ui">Gopass UI</a></p>
<p>Electron based UI wrapper for your gopass on the command line.
It makes your life easier by providing a rich graphical user
interface to search and manage your secrets.</p>
<p>Any feedback is welcome, as I'm no security expert and I'd be glad to have a
better and more secure workflow.</p>
<p>Thank you for reading.</p>
<p>Note: I've added some random memes to ease the reading.</p>
</div>
</div>
    </section><aside class="postpromonav"><nav><div itemprop="keywords" class="tags article__meta">
            <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/encryption/" rel="tag">#encryption</a>
            <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/gpg/" rel="tag">#gpg</a>
            <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/password-manager/" rel="tag">#password manager</a>
            <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/security/" rel="tag">#security</a>
        </div>

            <div class="pager hidden-print pagination">
            <span class="previous">
                <a class="hover:pagination__link" href="../raspberries-hobby-cluster/" rel="prev" title="Raspberry Pi hobby cluster">Previous post</a>
            </span>
            <span class="next">
                <a class="hover:pagination__link" href="../pycon-france-2019-experience/" rel="next" title="PyCon France 2019 experience">Next post</a>
            </span>
        </div>

    </nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="woile",
            disqus_url="https://woile.github.io/posts/sharing-team-secrets/",
        disqus_title="Sharing passwords using gopass, git and gpg",
        disqus_identifier="cache/posts/sharing-team-secrets.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="woile";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script></main>
</div>
    </div>
                <script src="../../assets/js/index.js"></script><script src="../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-77945905-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
