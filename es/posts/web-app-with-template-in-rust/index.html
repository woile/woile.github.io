<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="Writing a web application in rust using axum and minijinja. If you have used jinja2 in the past this will feel familiar. But we also dig into protocols and networking.">
<meta name="viewport" content="width=device-width">
<title>A Rust web app with HTML templates | Willy's blog</title>
<link href="../../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/index.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<style>
        .highlight pre, .code pre {
            white-space: pre;
        }
        </style>
<style>
        kbd {
            font-family: Consolas, "Lucida Console", monospace;
            display: inline-block;
            border-radius: 3px;
            padding: 0px 4px;
            box-shadow: 1px 1px 1px #777;
            margin: 2px;
            font-size: small;
            vertical-align: text-bottom;
            background: #eee;
            font-weight: 500;
            color: #555;
            cursor: pointer;
            font-variant: small-caps;
            font-weight: 600;

            /* This two work */
            /* letter-spacing: 0.5px; */
            letter-spacing: 1px;


            /* Prevent selection */
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        </style>
<script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script><link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" hreflang="es" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://woile.dev/es/posts/web-app-with-template-in-rust/">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><script src="https://cdn.counter.dev/script.js" data-id="acc7e853-fadb-4b91-a2f2-801890951f1e" data-utcoffset="1"></script><meta name="author" content="Woile">
<link rel="prev" href="../logging-in-python/" title="Logging in python" type="text/html">
<meta property="og:site_name" content="Willy's blog">
<meta property="og:title" content="A Rust web app with HTML templates">
<meta property="og:url" content="https://woile.dev/es/posts/web-app-with-template-in-rust/">
<meta property="og:description" content="Writing a web application in rust using axum and minijinja. If you have used jinja2 in the past this will feel familiar. But we also dig into protocols and networking.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-10-16T15:27:25Z">
<meta property="article:tag" content="jinja">
<meta property="article:tag" content="networking">
<meta property="article:tag" content="rust">
<meta property="article:tag" content="templates">
<link rel="alternate" hreflang="en" href="../../../posts/web-app-with-template-in-rust/">
<link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
</head>
<body>
    <input id="dark-mode" type="checkbox"><div class="theme">
        
    <header class="cover"><input id="cool-menu" type="checkbox"><label for="cool-menu" class="cool-menu__label">
        <svg class="cool-menu hover:cool-menu checked:cool-menu" viewbox="0 0 100 100" width="40" height="40" aria-hidden="true"><circle cx="50" cy="50" r="50" fill-opacity="0.5"></circle></svg></label>
    <nav class="menu"><ul>
<li><a class="hover:menu__link" href="../../">ğŸ  Inicio</a></li>
                <li><a class="hover:menu__link" href="../../../blog/">ğŸ“° Blog</a></li>
                <li><a class="hover:menu__link" href="../../mentoring/">ğŸ“— Mentoreo</a></li>
                <li><a class="hover:menu__link" href="../../archive.html">ğŸ—„ï¸ Archivo</a></li>
                <li><a class="hover:menu__link" href="../../categories/index.html">ğŸ·ï¸ Tags</a></li>
                <li><a class="hover:menu__link" href="../../../rss.xml">ğŸ›°ï¸ RSS feed</a></li>

        
        
        
        </ul>
<ul>
<li>
                        <span id="toptranslations">
                        <a href="../../../" class="hover:menu__link" rel="alternate" hreflang="en">English</a>

        </span>

            </li>
            <li>
                <label class="dark-mode-label hover:dark-mode-label" for="dark-mode">
                    <?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generator: Gravit.io --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="isolation: isolate;" viewbox="0 0 416 416" width="30px" height="30px"><defs><clippath id="_clipPath_qEPwrMg7OPn6mDBNPkG6Nqc7qffgU4IC"><rect width="416" height="416"></rect></clippath></defs><g clip-path="url(#_clipPath_qEPwrMg7OPn6mDBNPkG6Nqc7qffgU4IC)"><path d=" M 304 88 C 304 57.38 299.49 26.39 288 0 C 364.43 33.27 416 111.32 416 200 C 416 319.29 319.29 416 200 416 C 111.32 416 33.27 364.43 0 288 C 26.39 299.49 57.38 304 88 304 C 207.29 304 304 207.29 304 88 Z "></path></g></svg></label>
            </li>
        </ul></nav><h3 id="brand"><a href="../../" title="Willy's blog" rel="home">
            <span id="blog-title">Willy's blog</span>
        </a></h3>

    <div>

    </div>

    </header><div class="layout">
            <main id="content" class="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h2 class="p-name entry-title header__title" itemprop="headline name"><a href="." class="u-url hover:header__title__link">A Rust web app with HTML templates</a></h2>

        <div class="metadata" style="margin-bottom: 3rem;">
            <span class="byline author vcard p-author h-card" style="display: flex;column-gap: 1rem; flex-wrap: wrap;">
                <span class="byline-name fn p-name" itemprop="author">
                        Woile
                </span>
                <span class="dateline">
                    <a class="article__meta__link hover:article__meta__link" href="." rel="bookmark">
                    <time class="published dt-published" datetime="2022-10-16T15:27:25Z" itemprop="datePublished" title="2022-10-16 15:27">2022-10-16 15:27</time></a>
                </span>
                        <span class="sourceline"><a class="article__meta__link hover:article__meta__link" href="index.md">CÃ³digo fuente</a></span>

            </span>
            <br><span style="display: flex;column-gap: 1rem; flex-wrap: wrap;">
                <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/jinja/" rel="tag">#jinja</a>
                <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/networking/" rel="tag">#networking</a>
                <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/rust/" rel="tag">#rust</a>
                <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/templates/" rel="tag">#templates</a>
            </span>

                <span class="commentline">

        </span>
</div>
        
    </header><section class="e-content entry-content" itemprop="articleBody text"><p>The other day, I was helping my girlfriend with Go templates in a web server, and the internet is full of tutorials and explanations. And I thought, what about doing the same in Rust? How hard can it be?</p>
<p>Spoilers: it's easy, but there's not much information around</p>
<p>Let's change that!</p>
<h3>The stack</h3>
<p>If you come from a language with a big standard library like Go, you should know that rust is a bit more lightweight. The language has decided to provide a slim std library with a top of the line package manager and tools. It's up to the community to provide packages like web servers or templating.</p>
<p>If you come from Python, even though there's a big standard library, when doing web, is not used by developers. Instead, you are probably used to libraries like Django, Jinja2 or Fastapi. If that's the case, you are gonna feel familiar with the following stack.</p>
<p>This makes me wonder... will Go end up in the same direction as python? Is there something in the standard library that the community doesn't use, and instead, relies on a third party package? Anyways...</p>
<p>If you come from Javascript, you are probably used to installing many dependencies, so you are already familiar with what's coming next.</p>
<p>Let's get back to our stack.</p>
<h4>Axum</h4>
<p><a href="https://github.com/tokio-rs/axum">Axum</a> is one of the favorite web frameworks in the rust landscape. It's not as mature as Actix Web (which continues to rock). But it's getting a lot of traction, because of it's great integration with tokio and its ecosystem. <a href="https://github.com/tokio-rs/axum">Axum</a> was created by <a href="https://github.com/davidpdrsn">David Pedersen</a> from <a href="https://github.com/EmbarkStudios">EmbarkStudios</a>. This company seems to be taking rust to the next level ğŸ™ŒğŸ¼ ğŸš€.</p>
<h4>Minijinja</h4>
<p><a href="https://github.com/mitsuhiko/minijinja/">Minijinja</a> is the rust implementation of Python's Jinja2 by the very same awesome author: <a href="https://lucumr.pocoo.org/">mitsuhiko</a>. A lot of people are already familiar with it and with good reason, it's easy to use.</p>
<h4>Tokio</h4>
<p>The most popular async runtime. It's ideal for writing network applications. Like our web app, built with Axum.
<a href="https://tokio.rs/">Tokio</a> has a big ecosystem, from tracing to database drivers.</p>
<h4>Serde</h4>
<p><a href="https://serde.rs/">Serde</a> again, is the most popular way to serialize and deserialize data structures in rust. You serialize or deserialize from one format to another. For example, if you receive a JSON as bytes from an HTTP request, with serde you are going to be able to read the different fields, or load some of that information into a <code>struct</code>.</p>
<p><a href="https://serde.rs/">Serde</a>'s most common way to use is to derive the <code>Serialize</code> or <code>Deserialize</code> macros in your <code>struct</code>. From there,
you can probably read from, or serialize into different formats, many implemented by the community. Some of the list include JSON, TOML, AVRO, and more.</p>
<p>In our case, minijinja requires the <code>Serialize</code> macro in our structs to render the templates.</p>
<h3>Set up</h3>
<p>You've already <a href="https://www.rust-lang.org/tools/install">installed rust</a>, so go to your projects folder
and create a new rust project.</p>
<div class="code"><pre class="code literal-block">cargo new web-template-rs
<span class="nb">cd</span> web-template-rs/
</pre></div>
<p>With the following dependencies.</p>
<div class="code"><pre class="code literal-block">cargo add axum <span class="se">\</span>
    tokio -F tokio/full <span class="se">\</span>
    serde -F serde/derive <span class="se">\</span>
    minijinja -F minijinja/builtins
</pre></div>
<p>We use the <code>-F</code> flag to signal which features to include from those crates.</p>
<h3>The Code</h3>
<p>We are now ready to start. And we won't need anything else.</p>
<p>A basic webserver returning HTML without a template looks something like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">use</span><span class="w"> </span><span class="n">axum</span>::<span class="p">{</span><span class="n">response</span>::<span class="n">Html</span><span class="p">,</span><span class="w"> </span><span class="n">routing</span>::<span class="n">get</span><span class="p">,</span><span class="w"> </span><span class="n">Router</span><span class="p">};</span><span class="w"></span>

<span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">home</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">Html</span><span class="o">&lt;&amp;'</span><span class="nb">static</span><span class="w"> </span><span class="kt">str</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Html</span><span class="p">(</span><span class="s">"hello world"</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cp">#[tokio::main]</span><span class="w"></span>
<span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// build our application with a single route</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Router</span>::<span class="n">new</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="s">"/"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">get</span><span class="p">(</span><span class="n">home</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// run it with hyper on localhost:3000</span>
<span class="w">    </span><span class="n">axum</span>::<span class="n">Server</span>::<span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="s">"0.0.0.0:3000"</span><span class="p">.</span><span class="n">parse</span><span class="p">().</span><span class="n">unwrap</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">serve</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">into_make_service</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="k">await</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<p>To run our application we run</p>
<div class="code"><pre class="code literal-block">cargo run
</pre></div>
<p>Because we haven't configured any logging, you won't see anything in your terminal after running, that's fine.
If you want to learn how to do it, check the <a href="https://github.com/tokio-rs/axum/tree/main/examples/tracing-aka-logging">tracing-example</a>.</p>
<p>In the meanwhile, in your browser go to <code>0.0.0.0:3000</code> and observe the "hello world" text.</p>
<h4>What has happened here?</h4>
<p>When you type a URL or IP in the browser and press <kbd>enter</kbd>, the browser will "craft"
a GET HTTP request, and send it over a TCP connection to the given IP. If you provide a URL instead (<code>www.example.com</code>), the browser would have to resolve the IP through DNS. But in our case, we are using directly an IP.</p>
<p>What are all these acronyms? <a href="https://www.ietf.org/rfc/rfc793.html">TCP</a>, <a href="https://www.rfc-editor.org/rfc/rfc791.html">IP</a>, <a href="https://www.rfc-editor.org/rfc/rfc2616">HTTP</a>, <a href="https://www.rfc-editor.org/rfc/rfc1035.html">DNS</a>. They are all Internet Standards. Conventions to guarantee interoperability, they make the internet work. Then is up to people to make actual tools around those protocols. If you want your coffee machine to communicate over the internet, when you start coding its code, you will have to handle all those protocols (or find libraries that already do it for you).</p>
<p>Remember: <strong>HTTP is plain text</strong></p>
<p>The request your browser will craft, will look something like this:</p>
<div class="code"><pre class="code literal-block"><span class="nf">GET</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:3000</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">*/*</span>
</pre></div>
<p>And it will be sent over the internet inside an HTTP request, which itself will travel inside a TCP packet, which itself travels inside an IP packet. But actually, we are doing this on our local machine, so it won't reach the internet, your computer knows there is someone listening to <code>0.0.0.0</code> right away.</p>
<div class="code"><pre class="code literal-block">   IP
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚          TCP                   â”‚
 â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚         â”‚           HTTP       â”‚
 â”‚         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚         â”‚          â”‚  GET /    â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre></div>
<p>The request will be received by our rust web server, and it will attempt to handle the "requested" path (<code>GET /</code>).
No matter what language you use: rust, python, go, js, etc. requests are all plain text.</p>
<p>Our rust web server, actually knows how to handle that request, because it includes a <code>route</code></p>
<div class="code"><pre class="code literal-block"><span class="c1">// ...</span>
<span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="s">"/"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">get</span><span class="p">(</span><span class="n">home</span><span class="p">),</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
<p><a href="https://github.com/tokio-rs/axum">Axum</a> sees the <code>/</code> and it know it has a function to handle that path. That function actually means something like</p>
<blockquote>
<p>return an HTTP response containing HTML with the text "hello world"</p>
</blockquote>
<p>And what will axum create? <strong>a plain text HTTP response</strong></p>
<div class="code"><pre class="code literal-block"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">content-type</span><span class="o">:</span> <span class="l">text/html; charset=utf-8</span>
<span class="na">content-length</span><span class="o">:</span> <span class="l">11</span>
<span class="na">date</span><span class="o">:</span> <span class="l">Mon, 17 Oct 2022 08:03:24 GMT</span>

hello world
</pre></div>
<p>Your browser will receive the response and render a nice white background with the given text.</p>
<p>Enough with networking lessons woile! I want to know how to use templates.</p>
<p>True, true... I forgot where were we going with all this... but do we know what templates are?</p>
<h3>Templates</h3>
<p>You mix a "custom language", with your target language. This way, you can output the target language from a different one. Let's say we want to create an HTML with a list of users from Rust, Python or Go:</p>
<div class="code"><pre class="code literal-block"><span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>Timmy<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>Benji<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>Mimi<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre></div>
<p>What happens when we have a new user? We would have to edit it manually, right? Can we make this behave "dynamically" instead?</p>
<p>Yes, using templates. Minijinja is a rust implementation of the popular python's <code>jinja2</code>. A popular "template engine" with its own language. Template engines are endless, and they don't share the same syntax. Python django's template engine, Go templates, JSX (right?), lodash templates, and more. They end up being similar, they have a way to iterate, show data, or use conditions.</p>
<p>Now with a template engine, we can write something like this:</p>
<div class="code"><pre class="code literal-block"><span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    {% for user in users %}
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>user.name<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    {% endfor %}
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre></div>
<p>This way, our fictional user service, can take this template, fetch the users, and passing through the template, render the list of users.</p>
<p>Templates can be a monstrosity. Most of the time, the tooling around them is not good, and you don't get an error until you actually try to render them, you may not get syntax highlight. For example, around Kubernetes there's a famous package manager "Helm", which uses templates on top of YAML. YAML is already a <a href="https://noyaml.com/">controversial language</a>, and with a template layer on top, it can become incredibly hard to read and maintain. Spite of this, templates are still <strong>convenient</strong>, and I don't know of a better alternative.</p>
<h3>Axum with templates</h3>
<p>Back to our web application! This time, we are gonna create 2 fictional <code>structs</code>, that we'll use as examples.</p>
<div class="code"><pre class="code literal-block"><span class="k">use</span><span class="w"> </span><span class="n">serde</span>::<span class="n">Serialize</span><span class="p">;</span><span class="w"></span>

<span class="cp">#[derive(Debug, Serialize)]</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">Items</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">id</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">name</span>: <span class="nb">String</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cp">#[derive(Debug, Serialize)]</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">Profile</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">full_name</span>: <span class="nb">String</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">items</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Items</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<p>You can see we are using serde's <code>Serialize</code>, so minijinja can use them. And <code>Profile.items</code> is a <code>Vec</code>, this way we can showcase an iteration example in the template.</p>
<p>As we've seen templates, we are ready to write our jinja2 like template in rust.</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">PROFILE_TEMPLATE</span>: <span class="kp">&amp;</span><span class="o">'</span><span class="nb">static</span> <span class="kt">str</span> <span class="o">=</span><span class="w"> </span><span class="s">r#"</span>
<span class="s">&lt;!doctype html&gt;</span>

<span class="s">&lt;html lang="en"&gt;</span>
<span class="s">&lt;head&gt;</span>
<span class="s">  &lt;meta charset="utf-8"&gt;</span>
<span class="s">  &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;</span>

<span class="s">  &lt;title&gt;A Basic HTML5 Template&lt;/title&gt;</span>
<span class="s">  &lt;meta name="description" content="A basic HTML5 Template for new projects."&gt;</span>
<span class="s">  &lt;meta name="author" content="Woile"&gt;</span>
<span class="s">&lt;/head&gt;</span>

<span class="s">&lt;body&gt;</span>
<span class="s">    &lt;h1&gt;Profile of {{ profile.full_name|title }}&lt;/h1&gt;</span>
<span class="s">    &lt;p&gt;This is a template example to show some functionality&lt;/p&gt;</span>
<span class="s">    &lt;h2&gt;Items&lt;/h3&gt;</span>
<span class="s">    &lt;ul&gt;</span>
<span class="s">        {% for item in profile.items %}</span>
<span class="s">        &lt;li&gt;{{ item.name }} ({{ item.id }})&lt;/li&gt;</span>
<span class="s">        {% endfor %}</span>
<span class="s">    &lt;ul&gt;</span>
<span class="s">&lt;/body&gt;</span>
<span class="s">&lt;/html&gt;</span>
<span class="s">"#</span><span class="p">;</span><span class="w"></span>
</pre></div>
<p>Right in the body of the HTML, we show the <code>profile.full_name</code>, and then we iterate over each item, displaying the <code>name</code> and the <code>id</code>.</p>
<p>And for Axum, we add a new route, that will create some example structs.</p>
<div class="code"><pre class="code literal-block"><span class="k">use</span><span class="w"> </span><span class="n">axum</span>::<span class="p">{</span><span class="n">response</span>::<span class="n">Html</span><span class="p">,</span><span class="w"> </span><span class="n">routing</span>::<span class="n">get</span><span class="p">,</span><span class="w"> </span><span class="n">Router</span><span class="p">,</span><span class="w"> </span><span class="n">extract</span>::<span class="n">Path</span><span class="p">};</span><span class="w"></span>
<span class="k">use</span><span class="w"> </span><span class="n">minijinja</span>::<span class="n">render</span><span class="p">;</span><span class="w"></span>

<span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">home</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">Html</span><span class="o">&lt;&amp;'</span><span class="nb">static</span><span class="w"> </span><span class="kt">str</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Html</span><span class="p">(</span><span class="s">"hello world"</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">get_profile</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">profile_name</span><span class="p">)</span>: <span class="nc">Path</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Html</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">orders_example</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="n">Items</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">id</span>: <span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">name</span>: <span class="s">"Article banana"</span><span class="p">.</span><span class="n">into</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="n">Items</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">id</span>: <span class="mi">2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">name</span>: <span class="s">"Article apple"</span><span class="p">.</span><span class="n">into</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">profile_example</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Profile</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">full_name</span>: <span class="nc">profile_name</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">items</span>: <span class="nc">orders_example</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">render</span><span class="o">!</span><span class="p">(</span><span class="n">PROFILE_TEMPLATE</span><span class="p">,</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">profile_example</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Html</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cp">#[tokio::main]</span><span class="w"></span>
<span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Router</span>::<span class="n">new</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="s">"/"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">get</span><span class="p">(</span><span class="n">home</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="s">"/:profile_name"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">get</span><span class="p">(</span><span class="n">get_profile</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// run it with hyper on localhost:3000</span>
<span class="w">    </span><span class="n">axum</span>::<span class="n">Server</span>::<span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="s">"0.0.0.0:3000"</span><span class="p">.</span><span class="n">parse</span><span class="p">().</span><span class="n">unwrap</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">serve</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">into_make_service</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="k">await</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<p>Too complicated?</p>
<p>Let's take a look at this 2 lines:</p>
<div class="code"><pre class="code literal-block"><span class="s">"/:profile_name"</span><span class="p">,</span><span class="w"></span>
<span class="n">get</span><span class="p">(</span><span class="n">get_profile</span><span class="p">),</span><span class="w"></span>
</pre></div>
<p>The first line is the <code>path</code>, which is a the root <code>/</code> + a variable value <code>:profile_name</code>.
And right in the next line, we call the <code>get_profile</code>, which we can see how it uses the <code>profile_name</code> variable, extracted from the <code>path</code>.</p>
<p>After that, we create the example <code>structs</code>. In a real example, that information would probably come from a database.</p>
<p>And then, inside the <code>get_profile</code> we have:</p>
<div class="code"><pre class="code literal-block"><span class="kd">let</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">render</span><span class="o">!</span><span class="p">(</span><span class="n">PROFILE_TEMPLATE</span><span class="p">,</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">profile_example</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">Html</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="w"></span>
</pre></div>
<p>Where <code>render!</code> is minijinja's macro, that receives the template we previous declared, and then we provide some kind of "map" between the variables used in the template first, and then the rust variable.</p>
<p>A downside here is, that if we have an error in our template, we are only going to see it during runtime.
But on the bright side, this introduction was a quick way to get started with templates and axum in Rust.</p>
<p>The code is available on <a href="https://github.com/woile/web-template-rs-example">github.com/woile/web-template-rs-example</a></p>
<blockquote>
<p>Hey, hello ğŸ‘‹</p>
<p>Interested in what I write? follow me on <a href="https://twitter.com/santiwilly">twitter</a>
</p>
</blockquote>
    </section><aside class="postpromonav"><nav><ul itemprop="keywords" class="tags article__meta">
<li>
            <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/jinja/" rel="tag">#jinja</a>
          </li>
          <li>
            <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/networking/" rel="tag">#networking</a>
          </li>
          <li>
            <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/rust/" rel="tag">#rust</a>
          </li>
          <li>
            <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/templates/" rel="tag">#templates</a>
          </li>
        </ul>
<ul class="pager hidden-print pagination">
<li class="next">
            </li>
            <li class="previous">
                <a class="hover:pagination__link" href="../logging-in-python/" rel="prev" title="Logging in python">PublicaciÃ³n anterior</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script><div id="comment-section"></div>
<script>
initComments({
  node: document.getElementById("comment-section"),
  defaultHomeserverUrl: "https://matrix.cactus.chat:8448",
  serverName: "cactus.chat",
  siteName: "woile.dev",
  commentSectionId: "a.rust.web.app.with.html.templates"
})
</script></section></article></main>
</div>
    </div>
                <script src="../../../assets/js/index.js"></script><script src="../../../assets/js/mermaid.min.js"></script><script src="../../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
