<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="tutorial to write a command line interface with python decli">
<meta name="viewport" content="width=device-width">
<title>Tutorial: writing my dreamt cli using decli | Willy's blog</title>
<link href="../../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/index.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" hreflang="es" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://woile.dev/es/posts/creating-a-small-git-like-cli-with-decli/">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><script>
    if(!sessionStorage.getItem("_swa")&&document.referrer.indexOf(location.protocol+"//"+location.host)!== 0){ fetch("https://counter.dev/track?"+new URLSearchParams({ referrer:document.referrer,screen:screen.width+"x"+screen.height,user:"Woile",utcoffset:"1"}), { referrerPolicy: "no-referrer-when-downgrade"})};sessionStorage.setItem("_swa","1");
</script><meta name="author" content="Woile">
<link rel="prev" href="../decrypt-filesystem/" title="Decrypt filesystem" type="text/html">
<link rel="next" href="../local-https-development-in-python-with-mkcert/" title="Local HTTPS development in Python with Mkcert" type="text/html">
<meta property="og:site_name" content="Willy's blog">
<meta property="og:title" content="Tutorial: writing my dreamt cli using decli">
<meta property="og:url" content="https://woile.dev/es/posts/creating-a-small-git-like-cli-with-decli/">
<meta property="og:description" content="tutorial to write a command line interface with python decli">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-09-14T14:33:02-03:00">
<meta property="article:tag" content="git python decli cli tutorial programming">
<link rel="alternate" hreflang="en" href="../../../posts/creating-a-small-git-like-cli-with-decli/">
</head>
<body>
    <input id="dark-mode" type="checkbox"><div class="theme">
        
    <header class="cover"><input id="cool-menu" type="checkbox"><label for="cool-menu" class="cool-menu__label">
        <svg class="cool-menu hover:cool-menu checked:cool-menu" viewbox="0 0 100 100" width="40" height="40" aria-hidden="true"><circle cx="50" cy="50" r="50" fill-opacity="0.5"></circle></svg></label>
    <nav class="menu"><ul>
<li><a class="hover:menu__link" href="../../">üè† Inicio</a></li>
                <li><a class="hover:menu__link" href="../../../blog/">üì∞ Blog</a></li>
                <li><a class="hover:menu__link" href="../../mentoring/">üìó Mentoreo</a></li>
                <li><a class="hover:menu__link" href="../../archive.html">üóÑÔ∏è Archivo</a></li>
                <li><a class="hover:menu__link" href="../../categories/index.html">üè∑Ô∏è Tags</a></li>
                <li><a class="hover:menu__link" href="../../../rss.xml">üõ∞Ô∏è RSS feed</a></li>

        
        
        
        </ul>
<ul>
<li>
                        <span id="toptranslations">
                        <a href="../../../" class="hover:menu__link" rel="alternate" hreflang="en">English</a>

        </span>

            </li>
            <li>
                <label class="dark-mode-label hover:dark-mode-label" for="dark-mode">
                    <?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generator: Gravit.io --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="isolation: isolate;" viewbox="0 0 416 416" width="30px" height="30px"><defs><clippath id="_clipPath_qEPwrMg7OPn6mDBNPkG6Nqc7qffgU4IC"><rect width="416" height="416"></rect></clippath></defs><g clip-path="url(#_clipPath_qEPwrMg7OPn6mDBNPkG6Nqc7qffgU4IC)"><path d=" M 304 88 C 304 57.38 299.49 26.39 288 0 C 364.43 33.27 416 111.32 416 200 C 416 319.29 319.29 416 200 416 C 111.32 416 33.27 364.43 0 288 C 26.39 299.49 57.38 304 88 304 C 207.29 304 304 207.29 304 88 Z "></path></g></svg></label>
            </li>
        </ul></nav><h3 id="brand"><a href="../../" title="Willy's blog" rel="home">
            <span id="blog-title">Willy's blog</span>
        </a></h3>

    <div>

    </div>

    </header><div class="layout">
            <main id="content" class="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h2 class="p-name entry-title header__title" itemprop="headline name"><a href="." class="u-url hover:header__title__link">Tutorial: writing my dreamt cli using decli</a></h2>

        <div class="metadata" style="margin-bottom: 3rem;">
            <span class="byline author vcard p-author h-card" style="display: flex;column-gap: 1rem; flex-wrap: wrap;">
                <span class="byline-name fn p-name" itemprop="author">
                        Woile
                </span>
                <span class="dateline">
                    <a class="article__meta__link hover:article__meta__link" href="." rel="bookmark">
                    <time class="published dt-published" datetime="2018-09-14T14:33:02-03:00" itemprop="datePublished" title="2018-09-14 14:33">2018-09-14 14:33</time></a>
                </span>
                        <span class="sourceline"><a class="article__meta__link hover:article__meta__link" href="index.rst">C√≥digo fuente</a></span>

            </span>
            <br><span style="display: flex;column-gap: 1rem; flex-wrap: wrap;">
                <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/git-python-decli-cli-tutorial-programming/" rel="tag">#git python decli cli tutorial programming</a>
            </span>

                <span class="commentline">        



        </span>
</div>
        
    </header><section class="e-content entry-content" itemprop="articleBody text"><p>So for a long time I've been using different cli tools, mostly <code>argparse</code> because this way I had zero dependencies,
less worries, this is pure personal preference.</p>
<p>Other tools such as click or docopt, the way the code must be written, is not something I'm really fond of.</p>
<p>Because of this, I created <a class="reference external" href="https://github.com/Woile/decli">decli</a>, which is a declarative command line utility. Super simple.
Which is basically a wrapper around argparse.
Just write a dict and you are ready to go.</p>
<p>In this tutorial we are gonna try to simulate a <em>git command line tool</em>.
Let's create a few commands which will just print a message.</p>
<p>But we are gonna structure the code, the way I always wanted to hehe.</p>
<p>The commands will be decoupled from the <em>command line interface</em> (cli from now on).</p>
<!-- TEASER_END -->
<p>These are the git commands we are gonna cover:</p>
<pre class="literal-block">add
commit
push</pre>
<p>Our file structure will result in something like this:</p>
<pre class="literal-block">git-demo
‚îú‚îÄ‚îÄ git
‚îÇ   ‚îú‚îÄ‚îÄ commands
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ add.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commit.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ push.py
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ __main__.py
‚îî‚îÄ‚îÄ pyproject.toml</pre>
<p>If you are gonna write code along with the tutorial, you can create those files already. You can skip the <strong>pyproject.toml</strong>.</p>
<p>The code for this tutorial is <a class="reference external" href="https://github.com/Woile/decli-git-demo">hosted in github</a>.</p>
<section id="installation"><h2>Installation</h2>
<aside class="admonition warning"><p class="admonition-title">Warning</p>
<p>Python3! Everything here is python3!</p>
</aside><p>I like the new package manager <code>poetry</code> which uses the new <strong>pyproject.toml</strong> file. So let's install:</p>
<pre class="literal-block">poetry add decli</pre>
<p>Otherwise if you want to use pip:</p>
<pre class="literal-block">python -m venv venv
source venv/bin/activate
pip install -U decli</pre>
<section id="the-pyproject-toml-file"><h3>The pyproject.toml file</h3>
<p>If you haven't seen how a <strong>pyproject.toml</strong> looks, it's something like this:</p>
<pre class="literal-block">[tool.poetry]
name = "decli-git-demo"
version = "0.1.0"
description = "A git like demo"

[tool.poetry.dependencies]
python = "*"
decli = "^0.5.0"

[tool.poetry.dev-dependencies]
pytest = "^3.0"
flake8 = "^3.5"
mypy = "^0.620.0"</pre>
<p>Pretty simple, right?</p>
</section></section><section id="writing-the-interface"><h2>Writing the interface</h2>
<p>We are gonna write the <strong>cli</strong> in the <code>___main__.py</code> file, so we can treat the folder <code>git</code> as a module.
Look at the file structure if in doubt.</p>
<p>In order to use it as a module, we need to provide the <code>-m</code> flag, to the python interpreter.
Our resulting command would look something like this:</p>
<p><code>python -m git &lt;top_level_arguments&gt; &lt;subcommand&gt; &lt;sub_arguments&gt;</code>.</p>
<p>Example:</p>
<pre class="literal-block">python -m git --debug commit --amend</pre>
<p>For the interface, using <strong>decli</strong>, we need to create a dict. Let's dive into it.</p>
<section id="main-component"><h3>Main component</h3>
<pre class="code python"><a id="rest_code_00c7724fbe654c899078ef964e3e51e5-1" name="rest_code_00c7724fbe654c899078ef964e3e51e5-1" href="#rest_code_00c7724fbe654c899078ef964e3e51e5-1"></a><span class="kn">from</span> <span class="nn">decli</span> <span class="kn">import</span> <span class="n">cli</span>
<a id="rest_code_00c7724fbe654c899078ef964e3e51e5-2" name="rest_code_00c7724fbe654c899078ef964e3e51e5-2" href="#rest_code_00c7724fbe654c899078ef964e3e51e5-2"></a>
<a id="rest_code_00c7724fbe654c899078ef964e3e51e5-3" name="rest_code_00c7724fbe654c899078ef964e3e51e5-3" href="#rest_code_00c7724fbe654c899078ef964e3e51e5-3"></a><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<a id="rest_code_00c7724fbe654c899078ef964e3e51e5-4" name="rest_code_00c7724fbe654c899078ef964e3e51e5-4" href="#rest_code_00c7724fbe654c899078ef964e3e51e5-4"></a>    <span class="s2">"prog"</span><span class="p">:</span> <span class="s2">"git"</span><span class="p">,</span>
<a id="rest_code_00c7724fbe654c899078ef964e3e51e5-5" name="rest_code_00c7724fbe654c899078ef964e3e51e5-5" href="#rest_code_00c7724fbe654c899078ef964e3e51e5-5"></a>    <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"These are common Git commands used in various situations"</span>
<a id="rest_code_00c7724fbe654c899078ef964e3e51e5-6" name="rest_code_00c7724fbe654c899078ef964e3e51e5-6" href="#rest_code_00c7724fbe654c899078ef964e3e51e5-6"></a><span class="p">}</span>
<a id="rest_code_00c7724fbe654c899078ef964e3e51e5-7" name="rest_code_00c7724fbe654c899078ef964e3e51e5-7" href="#rest_code_00c7724fbe654c899078ef964e3e51e5-7"></a>
<a id="rest_code_00c7724fbe654c899078ef964e3e51e5-8" name="rest_code_00c7724fbe654c899078ef964e3e51e5-8" href="#rest_code_00c7724fbe654c899078ef964e3e51e5-8"></a><span class="n">parser</span> <span class="o">=</span> <span class="n">cli</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="rest_code_00c7724fbe654c899078ef964e3e51e5-9" name="rest_code_00c7724fbe654c899078ef964e3e51e5-9" href="#rest_code_00c7724fbe654c899078ef964e3e51e5-9"></a><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</pre>
<p>This part is the entrypoint of our cli.</p>
<p>The <code>prog</code> key is the name of the app, it will be used in the help information, same as <code>description</code>.
Let's see how this works:</p>
<pre class="literal-block">$ python -m git --help
usage: git [-h]

These are common Git commands used in various situations

optional arguments:
-h, --help  show this help message and exit</pre>
</section><section id="arguments"><h3>Arguments</h3>
<p>Let's add some global arguments, we want to have <code>debug</code> and <code>version</code> available.
We are also going to add some code to handle the version flag.
And for now, if nothing is provided we'll print the args.</p>
<pre class="code python"><a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-1" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-1" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-1"></a><span class="kn">import</span> <span class="nn">sys</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-2" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-2" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-2"></a><span class="kn">from</span> <span class="nn">decli</span> <span class="kn">import</span> <span class="n">cli</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-3" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-3" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-3"></a>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-4" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-4" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-4"></a><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-5" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-5" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-5"></a>    <span class="s2">"prog"</span><span class="p">:</span> <span class="s2">"git"</span><span class="p">,</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-6" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-6" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-6"></a>    <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"These are common Git commands used in various situations"</span><span class="p">,</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-7" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-7" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-7"></a>    <span class="s2">"arguments"</span><span class="p">:</span> <span class="p">[</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-8" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-8" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-8"></a>        <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"-v"</span><span class="p">,</span> <span class="s2">"--version"</span><span class="p">],</span> <span class="s2">"action"</span><span class="p">:</span> <span class="s2">"store_true"</span><span class="p">},</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-9" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-9" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-9"></a>        <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"--debug"</span><span class="p">,</span> <span class="s2">"action"</span><span class="p">:</span> <span class="s2">"store_true"</span><span class="p">},</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-10" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-10" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-10"></a>    <span class="p">],</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-11" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-11" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-11"></a><span class="p">}</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-12" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-12" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-12"></a>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-13" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-13" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-13"></a><span class="n">parser</span> <span class="o">=</span> <span class="n">cli</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-14" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-14" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-14"></a><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-15" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-15" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-15"></a>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-16" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-16" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-16"></a><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">version</span><span class="p">:</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-17" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-17" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">"0.1.0"</span><span class="p">)</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-18" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-18" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-18"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-19" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-19" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-19"></a>
<a id="rest_code_24faf6d42c9843209e53eb6939b8d47c-20" name="rest_code_24faf6d42c9843209e53eb6939b8d47c-20" href="#rest_code_24faf6d42c9843209e53eb6939b8d47c-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre>
<p>Let's take a look at the help, also to what happens when calling with the <code>version</code> flag, and when nothing is provided.</p>
<pre class="literal-block">$ python -m git --help
usage: git [-h] [-v] [--debug]

These are common Git commands used in various situations

optional arguments:
-h, --help     show this help message and exit
-v, --version
--debug</pre>
<pre class="literal-block">$ python -m git --version
0.1.0</pre>
<pre class="literal-block">$ python -m git
Namespace(debug=False, version=False)</pre>
<p>Awesome, this is looking promising.</p>
</section><section id="subcommands"><h3>Subcommands</h3>
<p>Last thing we are missing are the subcommands, we said we were gonna cover <code>add</code>, <code>commit</code>, and <code>push</code>.
Each one will have a unique sub-argument (just as an example).
Also, each one will use a class that we are gonna implement later. So no output example for now.</p>
<p>Some extras:</p>
<ul class="simple">
<li><p>We are gonna print the help if nothing is provided.</p></li>
<li><p>We are gonna call a <code>run</code> method from the classes that we are gonna define later.</p></li>
</ul>
<pre class="code python"><a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-1" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-1" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-1"></a><span class="kn">import</span> <span class="nn">sys</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-2" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-2" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-2"></a><span class="kn">from</span> <span class="nn">decli</span> <span class="kn">import</span> <span class="n">cli</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-3" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-3" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-3"></a><span class="kn">from</span> <span class="nn">.commands</span> <span class="kn">import</span> <span class="n">Add</span><span class="p">,</span> <span class="n">Commit</span><span class="p">,</span> <span class="n">Push</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-4" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-4" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-4"></a>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-5" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-5" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-5"></a><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-6" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-6" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-6"></a>    <span class="s2">"prog"</span><span class="p">:</span> <span class="s2">"git"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-7" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-7" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-7"></a>    <span class="s2">"description"</span><span class="p">:</span> <span class="s2">"These are common Git commands used in various situations"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-8" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-8" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-8"></a>    <span class="s2">"arguments"</span><span class="p">:</span> <span class="p">[</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-9" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-9" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-9"></a>        <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"-v"</span><span class="p">,</span> <span class="s2">"--version"</span><span class="p">],</span> <span class="s2">"action"</span><span class="p">:</span> <span class="s2">"store_true"</span><span class="p">},</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-10" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-10" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-10"></a>        <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"--debug"</span><span class="p">,</span> <span class="s2">"action"</span><span class="p">:</span> <span class="s2">"store_true"</span><span class="p">},</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-11" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-11" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-11"></a>    <span class="p">],</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-12" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-12" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-12"></a>    <span class="s2">"subcommands"</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-13" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-13" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-13"></a>        <span class="s2">"title"</span><span class="p">:</span> <span class="s2">"main"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-14" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-14" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-14"></a>        <span class="s2">"commands"</span><span class="p">:</span> <span class="p">[</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-15" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-15" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-15"></a>            <span class="p">{</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-16" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-16" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-16"></a>                <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"add"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-17" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-17" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-17"></a>                <span class="s2">"help"</span><span class="p">:</span> <span class="s2">"Add file contents to the index"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-18" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-18" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-18"></a>                <span class="s2">"func"</span><span class="p">:</span> <span class="n">Add</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-19" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-19" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-19"></a>                <span class="s2">"arguments"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"--update"</span><span class="p">,</span> <span class="s2">"action"</span><span class="p">:</span> <span class="s2">"store_true"</span><span class="p">}],</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-20" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-20" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-20"></a>            <span class="p">},</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-21" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-21" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-21"></a>            <span class="p">{</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-22" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-22" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-22"></a>                <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"commit"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-23" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-23" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-23"></a>                <span class="s2">"help"</span><span class="p">:</span> <span class="s2">"Record changes to the repository"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-24" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-24" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-24"></a>                <span class="s2">"func"</span><span class="p">:</span> <span class="n">Commit</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-25" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-25" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-25"></a>                <span class="s2">"arguments"</span><span class="p">:</span> <span class="p">[</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-26" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-26" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-26"></a>                    <span class="p">{</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-27" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-27" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-27"></a>                        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"--amend"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-28" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-28" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-28"></a>                        <span class="s2">"action"</span><span class="p">:</span> <span class="s2">"store_true"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-29" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-29" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-29"></a>                        <span class="s2">"help"</span><span class="p">:</span> <span class="p">(</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-30" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-30" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-30"></a>                            <span class="s2">"Replace the tip of the current "</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-31" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-31" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-31"></a>                            <span class="s2">"branch by creating a new commit."</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-32" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-32" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-32"></a>                        <span class="p">),</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-33" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-33" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-33"></a>                    <span class="p">}</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-34" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-34" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-34"></a>                <span class="p">],</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-35" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-35" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-35"></a>            <span class="p">},</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-36" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-36" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-36"></a>            <span class="p">{</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-37" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-37" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-37"></a>                <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"push"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-38" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-38" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-38"></a>                <span class="s2">"help"</span><span class="p">:</span> <span class="s2">"Update remote refs along with associated objects"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-39" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-39" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-39"></a>                <span class="s2">"func"</span><span class="p">:</span> <span class="n">Push</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-40" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-40" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-40"></a>                <span class="s2">"arguments"</span><span class="p">:</span> <span class="p">[</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-41" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-41" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-41"></a>                    <span class="p">{</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-42" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-42" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-42"></a>                        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"--tags"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-43" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-43" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-43"></a>                        <span class="s2">"action"</span><span class="p">:</span> <span class="s2">"store_true"</span><span class="p">,</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-44" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-44" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-44"></a>                        <span class="s2">"help"</span><span class="p">:</span> <span class="p">(</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-45" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-45" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-45"></a>                            <span class="s2">"All refs under refs/tags are pushed, in"</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-46" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-46" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-46"></a>                            <span class="s2">" addition to refspecs explicitly listed "</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-47" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-47" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-47"></a>                            <span class="s2">"on the command line."</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-48" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-48" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-48"></a>                        <span class="p">),</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-49" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-49" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-49"></a>                    <span class="p">}</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-50" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-50" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-50"></a>                <span class="p">],</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-51" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-51" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-51"></a>            <span class="p">},</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-52" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-52" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-52"></a>        <span class="p">],</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-53" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-53" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-53"></a>    <span class="p">},</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-54" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-54" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-54"></a><span class="p">}</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-55" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-55" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-55"></a>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-56" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-56" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-56"></a><span class="n">parser</span> <span class="o">=</span> <span class="n">cli</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-57" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-57" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-57"></a><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-58" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-58" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-58"></a>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-59" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-59" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-59"></a><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">version</span><span class="p">:</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-60" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-60" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-60"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">"0.1.0"</span><span class="p">)</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-61" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-61" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-61"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-62" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-62" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-62"></a>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-63" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-63" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-63"></a><span class="c1"># print help if no arguments are provided</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-64" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-64" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-64"></a><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-65" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-65" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-65"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-66" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-66" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-66"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-67" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-67" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-67"></a>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-68" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-68" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-68"></a><span class="n">cmd</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
<a id="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-69" name="rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-69" href="#rest_code_d3fbe0f49e8d44c59ae6b08b0c27e3d2-69"></a><span class="n">cmd</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre>
<p>So this is how <code>___main__.py</code> should look like.</p>
</section></section><section id="writing-the-commands"><h2>Writing the commands</h2>
<p>Before, we left our application unfinished and not working, because it was missing the classes imported from the <code>commands</code> folder.
If you haven't created the folder and the files yet, go and do it. Remember also to create the <code>___init__.py</code> files.</p>
<p>It's interesting to observe how each class is unpacking the arguments that needs.</p>
<p>Also, each class is a normal python class, there's nothing needed, really <strong>easy to test</strong>, right?</p>
<p>A better implementation could be made, of course, having a parent class defining the interface and handling global arguments, would be interesting.
But I'll leave that for you.</p>
<section id="add"><h3>Add</h3>
<p>For <code>commands/app.py</code></p>
<pre class="code python"><a id="rest_code_ff5849ab4fbd4653b41be072895bb96f-1" name="rest_code_ff5849ab4fbd4653b41be072895bb96f-1" href="#rest_code_ff5849ab4fbd4653b41be072895bb96f-1"></a><span class="k">class</span> <span class="nc">Add</span><span class="p">:</span>
<a id="rest_code_ff5849ab4fbd4653b41be072895bb96f-2" name="rest_code_ff5849ab4fbd4653b41be072895bb96f-2" href="#rest_code_ff5849ab4fbd4653b41be072895bb96f-2"></a>
<a id="rest_code_ff5849ab4fbd4653b41be072895bb96f-3" name="rest_code_ff5849ab4fbd4653b41be072895bb96f-3" href="#rest_code_ff5849ab4fbd4653b41be072895bb96f-3"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="rest_code_ff5849ab4fbd4653b41be072895bb96f-4" name="rest_code_ff5849ab4fbd4653b41be072895bb96f-4" href="#rest_code_ff5849ab4fbd4653b41be072895bb96f-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
<a id="rest_code_ff5849ab4fbd4653b41be072895bb96f-5" name="rest_code_ff5849ab4fbd4653b41be072895bb96f-5" href="#rest_code_ff5849ab4fbd4653b41be072895bb96f-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update</span> <span class="o">=</span> <span class="n">update</span>
<a id="rest_code_ff5849ab4fbd4653b41be072895bb96f-6" name="rest_code_ff5849ab4fbd4653b41be072895bb96f-6" href="#rest_code_ff5849ab4fbd4653b41be072895bb96f-6"></a>
<a id="rest_code_ff5849ab4fbd4653b41be072895bb96f-7" name="rest_code_ff5849ab4fbd4653b41be072895bb96f-7" href="#rest_code_ff5849ab4fbd4653b41be072895bb96f-7"></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="rest_code_ff5849ab4fbd4653b41be072895bb96f-8" name="rest_code_ff5849ab4fbd4653b41be072895bb96f-8" href="#rest_code_ff5849ab4fbd4653b41be072895bb96f-8"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'running add... update: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="si">}</span><span class="s1">, debug: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></section><section id="commit"><h3>Commit</h3>
<p>For <code>commands/commit.py</code></p>
<pre class="code python"><a id="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-1" name="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-1" href="#rest_code_7100f62f98c6405c8e994e9c1d69b4c3-1"></a><span class="k">class</span> <span class="nc">Commit</span><span class="p">:</span>
<a id="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-2" name="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-2" href="#rest_code_7100f62f98c6405c8e994e9c1d69b4c3-2"></a>
<a id="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-3" name="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-3" href="#rest_code_7100f62f98c6405c8e994e9c1d69b4c3-3"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">amend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-4" name="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-4" href="#rest_code_7100f62f98c6405c8e994e9c1d69b4c3-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
<a id="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-5" name="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-5" href="#rest_code_7100f62f98c6405c8e994e9c1d69b4c3-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">amend</span> <span class="o">=</span> <span class="n">amend</span>
<a id="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-6" name="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-6" href="#rest_code_7100f62f98c6405c8e994e9c1d69b4c3-6"></a>
<a id="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-7" name="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-7" href="#rest_code_7100f62f98c6405c8e994e9c1d69b4c3-7"></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-8" name="rest_code_7100f62f98c6405c8e994e9c1d69b4c3-8" href="#rest_code_7100f62f98c6405c8e994e9c1d69b4c3-8"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Commiting... debug: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="si">}</span><span class="s1">, amend: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">amend</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></section><section id="push"><h3>Push</h3>
<p>For <code>commands/push.py</code></p>
<pre class="code python"><a id="rest_code_d92ecb04267e44029e1143b33bda5cb6-1" name="rest_code_d92ecb04267e44029e1143b33bda5cb6-1" href="#rest_code_d92ecb04267e44029e1143b33bda5cb6-1"></a><span class="k">class</span> <span class="nc">Push</span><span class="p">:</span>
<a id="rest_code_d92ecb04267e44029e1143b33bda5cb6-2" name="rest_code_d92ecb04267e44029e1143b33bda5cb6-2" href="#rest_code_d92ecb04267e44029e1143b33bda5cb6-2"></a>
<a id="rest_code_d92ecb04267e44029e1143b33bda5cb6-3" name="rest_code_d92ecb04267e44029e1143b33bda5cb6-3" href="#rest_code_d92ecb04267e44029e1143b33bda5cb6-3"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="rest_code_d92ecb04267e44029e1143b33bda5cb6-4" name="rest_code_d92ecb04267e44029e1143b33bda5cb6-4" href="#rest_code_d92ecb04267e44029e1143b33bda5cb6-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
<a id="rest_code_d92ecb04267e44029e1143b33bda5cb6-5" name="rest_code_d92ecb04267e44029e1143b33bda5cb6-5" href="#rest_code_d92ecb04267e44029e1143b33bda5cb6-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">tags</span>
<a id="rest_code_d92ecb04267e44029e1143b33bda5cb6-6" name="rest_code_d92ecb04267e44029e1143b33bda5cb6-6" href="#rest_code_d92ecb04267e44029e1143b33bda5cb6-6"></a>
<a id="rest_code_d92ecb04267e44029e1143b33bda5cb6-7" name="rest_code_d92ecb04267e44029e1143b33bda5cb6-7" href="#rest_code_d92ecb04267e44029e1143b33bda5cb6-7"></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="rest_code_d92ecb04267e44029e1143b33bda5cb6-8" name="rest_code_d92ecb04267e44029e1143b33bda5cb6-8" href="#rest_code_d92ecb04267e44029e1143b33bda5cb6-8"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Pushing... debug: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="si">}</span><span class="s1">, tags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></section><section id="init"><h3>Init</h3>
<p>We are gonna add this, in order to import directly from <code>commands</code>, instead of one by one.</p>
<p>For <code>commands/__init__.py</code></p>
<pre class="code python"><a id="rest_code_5208b4f24efd4b368331d17a902da8e7-1" name="rest_code_5208b4f24efd4b368331d17a902da8e7-1" href="#rest_code_5208b4f24efd4b368331d17a902da8e7-1"></a><span class="kn">from</span> <span class="nn">.add</span> <span class="kn">import</span> <span class="n">Add</span>
<a id="rest_code_5208b4f24efd4b368331d17a902da8e7-2" name="rest_code_5208b4f24efd4b368331d17a902da8e7-2" href="#rest_code_5208b4f24efd4b368331d17a902da8e7-2"></a><span class="kn">from</span> <span class="nn">.commit</span> <span class="kn">import</span> <span class="n">Commit</span>
<a id="rest_code_5208b4f24efd4b368331d17a902da8e7-3" name="rest_code_5208b4f24efd4b368331d17a902da8e7-3" href="#rest_code_5208b4f24efd4b368331d17a902da8e7-3"></a><span class="kn">from</span> <span class="nn">.push</span> <span class="kn">import</span> <span class="n">Push</span>
<a id="rest_code_5208b4f24efd4b368331d17a902da8e7-4" name="rest_code_5208b4f24efd4b368331d17a902da8e7-4" href="#rest_code_5208b4f24efd4b368331d17a902da8e7-4"></a>
<a id="rest_code_5208b4f24efd4b368331d17a902da8e7-5" name="rest_code_5208b4f24efd4b368331d17a902da8e7-5" href="#rest_code_5208b4f24efd4b368331d17a902da8e7-5"></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span>
<a id="rest_code_5208b4f24efd4b368331d17a902da8e7-6" name="rest_code_5208b4f24efd4b368331d17a902da8e7-6" href="#rest_code_5208b4f24efd4b368331d17a902da8e7-6"></a>    <span class="s1">'Add'</span><span class="p">,</span>
<a id="rest_code_5208b4f24efd4b368331d17a902da8e7-7" name="rest_code_5208b4f24efd4b368331d17a902da8e7-7" href="#rest_code_5208b4f24efd4b368331d17a902da8e7-7"></a>    <span class="s1">'Commit'</span><span class="p">,</span>
<a id="rest_code_5208b4f24efd4b368331d17a902da8e7-8" name="rest_code_5208b4f24efd4b368331d17a902da8e7-8" href="#rest_code_5208b4f24efd4b368331d17a902da8e7-8"></a>    <span class="s1">'Push'</span>
<a id="rest_code_5208b4f24efd4b368331d17a902da8e7-9" name="rest_code_5208b4f24efd4b368331d17a902da8e7-9" href="#rest_code_5208b4f24efd4b368331d17a902da8e7-9"></a><span class="p">)</span>
</pre></section></section><section id="now-what"><h2>Now what?</h2>
<p>That's it, our application is completed, let's see some output results.</p>
<section id="providing-nothing"><h3>Providing nothing</h3>
<pre class="literal-block">$ python -m git
usage: git [-h] [-v] [--debug] {add,commit,push} ...

These are common Git commands used in various situations

optional arguments:
-h, --help         show this help message and exit
-v, --version
--debug

main:
{add,commit,push}
    add              Add file contents to the index
    commit           Record changes to the repository
    push             Update remote refs along with associated objects</pre>
</section><section id="calling-add-command"><h3>Calling add command</h3>
<pre class="literal-block">$ python -m git add
running add... update: False, debug: False</pre>
</section><section id="calling-commit-command-with-a-sub-argument"><h3>Calling commit command with a sub-argument</h3>
<pre class="literal-block">$ python -m git commit --amend
Commiting... debug: False, amend: True</pre>
</section><section id="calling-push-command-with-global-and-sub-arguments"><h3>Calling push command with global and sub arguments</h3>
<pre class="literal-block">$ python -m git --debug push --tags
Pushing... debug: True, tags: True</pre>
</section><section id="help-for-one-of-the-commands"><h3>Help for one of the commands</h3>
<pre class="literal-block">$ python -m git commit --help
usage: git commit [-h] [--amend]

optional arguments:
-h, --help  show this help message and exit
--amend     Replace the tip of the current branch by creating a new commit.</pre>
<p>And that's it, we have succesfully created a nice and mantainable cli.</p>
<p>Keep in mind that if you already have a project, and you want to provide an interface, now you know how.</p>
<p>Hope it was a useful reading.</p>
</section></section></section><aside class="postpromonav"><nav><ul itemprop="keywords" class="tags article__meta">
<li>
            <a class="tag p-category article__meta__link hover:article__meta__link" href="../../categories/git-python-decli-cli-tutorial-programming/" rel="tag">#git python decli cli tutorial programming</a>
          </li>
        </ul>
<ul class="pager hidden-print pagination">
<li class="previous">
                <a class="hover:pagination__link" href="../decrypt-filesystem/" rel="prev" title="Decrypt filesystem">Publicaci√≥n anterior</a>
            </li>
            <li class="next">
                <a class="hover:pagination__link" href="../local-https-development-in-python-with-mkcert/" rel="next" title="Local HTTPS development in Python with Mkcert">Siguiente publicaci√≥n</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><div class="commentbox" id="commentbox"></div>

        <script src="https://unpkg.com/commentbox.io/dist/commentBox.min.js"></script><script>

        commentBox('5692121306628096-proj');
        </script><noscript>Please enable JavaScript to view the comments</noscript>


        </section></article></main>
</div>
    </div>
                <script src="../../../assets/js/index.js"></script><script src="../../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
